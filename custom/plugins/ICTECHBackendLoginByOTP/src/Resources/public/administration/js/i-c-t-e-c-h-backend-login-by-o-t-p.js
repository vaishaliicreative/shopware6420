!function(e){var n={};function o(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=n,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)o.d(t,i,function(n){return e[n]}.bind(null,i));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="/bundles/ictechbackendloginbyotp/",o(o.s="OW7Z")}({FTU5:function(e){e.exports=JSON.parse('{"sw-login":{"index":{"buttonSendOTP":"Send Otp"}}}')},HeCZ:function(e){e.exports=JSON.parse("{}")},OW7Z:function(e,n,o){"use strict";o.r(n);var t=o("FTU5"),i=o("HeCZ"),r=Shopware,s=r.Component,l=r.Mixin;s.override("sw-login-login",{template:'{% block sw_login_login %}\n    <form\n        class="sw-login-login"\n        @submit.prevent="createUserOtpWithEmail"\n    >\n        {% block sw_login_login_form_headline %}\n            <h2 class="sw-login__content-headline">\n                {{ $tc(\'sw-login.index.headlineForm\') }}\n            </h2>\n        {% endblock %}\n\n        {% block sw_login_login_alert %}\n            <sw-alert\n                v-if="showLoginAlert"\n                variant="info"\n                appearance="default"\n                :show-icon="true"\n                :closable="false"\n            >\n                {{ loginAlertMessage }}\n            </sw-alert>\n        {% endblock %}\n\n        {% block sw_login_login_user_field %}\n            <sw-text-field\n                v-model="username"\n                v-autofocus\n                :label="$tc(\'sw-login.index.labelUsername\')"\n                :placeholder="$tc(\'sw-login.index.placeholderUsername\')"\n                :disabled="showLoginAlert"\n                required\n            />\n        {% endblock %}\n\n        {% block sw_login_login_password_field %}\n\n        {% endblock %}\n\n        {% block sw_login_login_submit %}\n            <div class="sw-login__submit">\n                {% block sw_login_login_forgot_password %}\n\n                {% endblock %}\n                {% block sw_login_login_submit_button %}\n                    <sw-button\n                        :disabled="username.length <= 0 || showLoginAlert"\n                        class="sw-login__login-action"\n                        variant="primary"\n                    >\n                        {{ $tc(\'sw-login.index.buttonSendOTP\') }}\n                    </sw-button>\n                {% endblock %}\n            </div>\n        {% endblock %}\n    </form>\n{% endblock %}\n',inject:["configService"],mixins:[l.getByName("notification")],data:function(){return{username:"",loginAlertMessage:""}},computed:{showLoginAlert:function(){return"string"==typeof this.loginAlertMessage&&this.loginAlertMessage.length>=1}},created:function(){localStorage.getItem("sw-admin-locale")||Shopware.State.dispatch("setAdminLocale",navigator.language)},methods:{loginUserWithPassword:function(){var e=this;return this.$emit("is-loading"),this.loginService.loginByUsername(this.username).then((function(){e.handleLoginSuccess(),e.$emit("is-not-loading")})).catch((function(n){e.password="",e.handleLoginError(n),e.$emit("is-not-loading")}))},createUserOtpWithEmail:function(){var e=this;this.$emit("is-loading");var n=this.configService.getBasicHeaders();return this.configService.httpClient.post("/backend/login/generateotp",{params:{username:this.username},headers:n}).then((function(n){console.log(n.data.type),e.$emit("is-not-loading"),e.$router.push({path:"/login/verify"})}))},handleLoginSuccess:function(){var e=this;this.$emit("login-success");var n=new Promise((function(e){setTimeout(e,150)}));return this.licenseViolationService&&this.licenseViolationService.removeTimeFromLocalStorage(this.licenseViolationService.key.showViolationsKey),n.then((function(){e.$parent.isLoginSuccess=!1,e.forwardLogin(),sessionStorage.getItem("sw-login-should-reload")&&(sessionStorage.removeItem("sw-login-should-reload"),window.location.reload(!0))}))},forwardLogin:function(){var e=JSON.parse(sessionStorage.getItem("sw-admin-previous-route"));sessionStorage.removeItem("sw-admin-previous-route"),!Shopware.Context.app.firstRunWizard||this.$router.history.current.name.startsWith("sw.first.run.wizard.")?null!=e&&e.fullPath?this.$router.push(e.fullPath):this.$router.push({name:"core"}):this.$router.push({name:"sw.first.run.wizard.index"})},handleLoginError:function(e){var n=this;this.$emit("login-error"),setTimeout((function(){n.$emit("login-error")}),500),this.createNotificationFromResponse(e)}}}),Shopware.Locale.extend("en-GB",t),Shopware.Locale.extend("de-DE",i)}});
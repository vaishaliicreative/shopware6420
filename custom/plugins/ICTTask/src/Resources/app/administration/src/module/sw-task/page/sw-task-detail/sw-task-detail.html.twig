<!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->
{% block sw_task_detail %}
<sw-page class="sw-task-detail">

    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->
    {% block sw_task_detail_header %}
    <template #smart-bar-header>
        <h2>{{ placeholder(task, 'name', $tc('sw-task.detail.textHeadline')) }}</h2>
    </template>

    {% endblock %}

    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->
    {% block sw_task_detail_actions %}
    <template #smart-bar-actions>

        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->
        {% block sw_task_detail_actions_abort %}
        <sw-button
            v-tooltip.bottom="tooltipCancel"
            :disabled="taskIsLoading"
            @click="onCancel"
        >
            {{ $tc('sw-task.detail.buttonCancel') }}
        </sw-button>
        {% endblock %}

        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->
        {% block sw_task_detail_actions_save %}
        <sw-button-process
            v-model="isSaveSuccessful"
            v-tooltip.bottom="tooltipSave"
            class="sw-task-detail__save-action"
            :is-loading="isLoading"
            :disabled="isLoading || !acl.can('task.editor')"
            variant="primary"
            @click.prevent="onSave"
        >
            {{ $tc('sw-task.detail.buttonSave') }}
        </sw-button-process>
        {% endblock %}

    </template>
    {% endblock %}

    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->
    {% block sw_task_detail_language_switch %}
    <template #language-switch>
        <sw-language-switch
            :disabled="taskId == null"
            :save-changes-function="saveOnLanguageChange"
            :abort-change-function="abortOnLanguageChange"
            @on-change="onChangeLanguage"
        />
    </template>
    {% endblock %}

    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->
    {% block sw_task_detail_content %}
    <sw-card-view slot="content">
        <template v-if="taskIsLoading">
            <sw-skeleton variant="detail-bold" />
            <sw-skeleton />
        </template>

        <template v-else>

            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->
            {% block sw_task_detail_content_language_info %}
            <sw-language-info
                :entity-description="placeholder(task, 'name', $tc('sw-task.detail.textHeadline'))"
            />
            {% endblock %}

            <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->
            {% block sw_task_detail_base_basic_info_card %}
            <sw-card
                position-identifier="sw-task-detail-basic-info"
                :title="$tc('sw-task.detail.cardTitleTaskInfo')"
            >
                <sw-container
                    class="sw-task-detail__container"
                    columns="repeat(auto-fit, minmax(250px, 1fr))"
                    gap="0 30px"
                >
                    <div class="sw-task-detail__base-info-wrapper">

                        <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->
                        {% block sw_task_detail_base_info_field_name %}
                        <sw-field
                            v-model="task.name"
                            type="text"
                            :label="$tc('sw-task.detail.labelName')"
                            :placeholder="placeholder(task, 'name', $tc('sw-task.detail.placeholderName'))"
                            name="name"
                            validation="required"
                            required
                            :error="taskNameError"
                            :disabled="!acl.can('task.editor')"
                        />
                        {% endblock %}
                    </div>
                    <div class="sw-task-detail__base-info-wrapper">
                        {% block sw_task_detail_base_info_field_city %}
                            <sw-field
                                v-model="task.city"
                                type="text"
                                :label="$tc('sw-task.detail.labelCity')"
                                :placeholder="placeholder(task, 'city', $tc('sw-task.detail.placeholderCity'))"
                                name="city"
                                validation="required"
                                required
                                :error="taskCityError"
                                :disabled="!acl.can('task.editor')"
                            />
                        {% endblock %}
                    </div>

                    <div class="sw-task-detail__base-info-wrapper">
                        {% block sw_task_detail_base_info_field_country %}
                            <sw-entity-single-select
                                v-model="countryId"
                                class="sw-task-form_country-select"
                                entity="country"
                                :criteria="countryCriteria"
                                :label="$tc('sw-task.detail.labelCountry')"
                                :placeholder="$tc('sw-task.detail.placeholderCountry')"
                                show-clearable-button
                            />
                        {% endblock %}
                    </div>

                    <div class="sw-task-detail__base-info-wrapper">
                        {% block sw_task_detail_base_info_field_state %}
                            <sw-entity-single-select
                                v-model="task.countryStateId"
                                class="sw-task-form_country_state-select"
                                entity="country_state"
                                :criteria="stateCriteria"
                                :label="$tc('sw-task.detail.labelState')"
                                :placeholder="$tc('sw-task.detail.placeholderState')"
                                show-clearable-button
                            />
                        {% endblock %}
                    </div>
                    <div class="sw-task-detail__base-info-wrapper">
                        {% block sw_task_detail_base_info_field_product %}
                            <sw-entity-single-select
                                v-model="task.productId"
                                class="sw-task-form_product-select"
                                entity="product"
                                :criteria="productCriteria"
                                :label="$tc('sw-task.detail.labelProduct')"
                                :placeholder="$tc('sw-task.detail.placeholderProduct')"
                                show-clearable-button
                            />
                        {% endblock %}
                        {% block sw_task_detail_base_info_field_active %}
                            <sw-switch-field
                                v-model="task.active"
                                :label="$tc('sw-task.detail.labelActive')"
                            />
                        {% endblock %}
                    </div>
                    <!-- eslint-disable-next-line sw-deprecation-rules/no-twigjs-blocks -->
                    {% block sw_task_detail_logo_upload %}
                    <sw-upload-listener
                        :upload-tag="mediaUploadTag"
                        auto-upload
                        @media-upload-finish="setMediaItem"
                    />
                    <sw-media-upload-v2
                        class="sw-task-detail__logo-upload"
                        :source="task.mediaId"
                        :allow-multi-select="false"
                        variant="regular"
                        :upload-tag="mediaUploadTag"
                        :label="$tc('sw-task.detail.labelImage')"
                        :default-folder="taskRepository.entityName"
                        :disabled="!acl.can('task.editor')"
                        @sw-media-upload-v2-media-upload-success="setMediaItem"
                        @media-drop="onDropMedia"
                        @media-upload-sidebar-open="openMediaSidebar"
                        @media-upload-remove-image="onUnlinkLogo"
                    />
                    {% endblock %}
                </sw-container>

            </sw-card>
            {% endblock %}
        </template>
    </sw-card-view>
    {% endblock %}

</sw-page>
{% endblock %}
